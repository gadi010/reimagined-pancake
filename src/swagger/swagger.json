{
    "openapi": "3.0.0",
    "info": {
        "title": "Existing API for Project management System",
        "version": "1.0.0",
        "description": "API documentation for my backend service"
    },
    "servers": [
        {
            "url": "http://localhost:5000/api/v1",
            "description": "Development Server"
        }
    ],
     "tags": [
        {
            "name": "Authentication",
            "description": "User authentication and profile management"
        },
        {
            "name": "GitHub",
            "description": "GitHub repository integration and webhooks"
        },
        {
            "name": "Project",
            "description": "Project management and analytics"
        },
        {
            "name": "User",
            "description": "User management within projects"
        },
        {
            "name": "Work",
            "description": "Work items and task management"
        }
    ],
    "components": {
        "securitySchemes": {
            "bearerAuth": {
                "type": "http",
                "scheme": "bearer",
                "bearerFormat": "JWT"
            }
        },
        "schemas": {
            "User": {
                "type": "object",
                "properties": {
                    "id": {
                        "type": "integer",
                        "example": 1
                    },
                    "name": {
                        "type": "string",
                        "example": "John Doe"
                    },
                    "email": {
                        "type": "string",
                        "example": "john@example.com"
                    },
                    "avatar": {
                        "type": "string",
                        "example": "https://avatar.com/img.png"
                    },
                    "role": {
                        "type": "string",
                        "example": "101"
                    }
                }
            },
            "AddUserRequest": {
                "type": "object",
                "properties": {
                    "email": {
                        "type": "string",
                        "example": "john@example.com"
                    },
                    "projectId": {
                        "type": "integer",
                        "example": 123
                    },
                    "role": {
                        "type": "string",
                        "example": "101"
                    }
                },
                "required": [
                    "email",
                    "projectId",
                    "role"
                ]
            },
            "UserListResponse": {
                "type": "object",
                "properties": {
                    "total_count": {
                        "type": "integer",
                        "example": 15
                    },
                    "page": {
                        "type": "integer",
                        "example": 1
                    },
                    "page_size": {
                        "type": "integer",
                        "example": 10
                    },
                    "link": {
                        "type": "object",
                        "properties": {
                            "next": {
                                "type": [
                                    "string",
                                    "null"
                                ],
                                "example": "/projects/active?page=2&page_size=10"
                            },
                            "prev": {
                                "type": [
                                    "string",
                                    "null"
                                ],
                                "example": null
                            }
                        }
                    },
                    "data": {
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/User"
                        }
                    }
                }
            },
            "RegisterRequest": {
                "type": "object",
                "properties": {
                    "code": {
                        "type": "string",
                        "example": "1a2b3c"
                    }
                },
                "required": [
                    "code"
                ]
            },
            "RegisterResponse": {
                "type": "object",
                "properties": {
                    "access_token": {
                        "type": "string",
                        "example": "eyJhbGciOiJIUzI1NiIsInR..."
                    },
                    "user": {
                        "$ref": "#/components/schemas/User"
                    }
                }
            },
            "Project": {
                "type": "object",
                "properties": {
                    "id": {
                        "type": "integer",
                        "example": 1
                    },
                    "title": {
                        "type": "string",
                        "example": "Website Redesign"
                    },
                    "description": {
                        "type": "string",
                        "example": "Redesign the client website"
                    },
                    "dueDate": {
                        "type": "string",
                        "format": "date",
                        "example": "2025-12-31"
                    },
                    "createdById": {
                        "type": "integer",
                        "example": 123
                    },
                    "members": {
                        "type": "array",
                        "items": {
                            "type": "object",
                            "properties": {
                                "userId": {
                                    "type": "integer"
                                },
                                "role": {
                                    "type": "string"
                                }
                            }
                        }
                    },
                    "github": {
                        "type": "array",
                        "items": {
                            "type": "object",
                            "properties": {
                                "name": {
                                    "type": "string"
                                },
                                "repoId": {
                                    "type": "integer"
                                }
                            }
                        }
                    }
                }
            },
            "ProjectCreateRequest": {
                "type": "object",
                "properties": {
                    "title": {
                        "type": "string",
                        "example": "New Project"
                    },
                    "description": {
                        "type": "string",
                        "example": "Project description"
                    },
                    "dueDate": {
                        "type": "string",
                        "format": "date",
                        "example": "2025-12-31"
                    }
                },
                "required": [
                    "title",
                    "description"
                ]
            },
            "ProjectAnalytics": {
                "type": "object",
                "properties": {
                    "todo": {
                        "type": "integer",
                        "example": 5
                    },
                    "inProgress": {
                        "type": "integer",
                        "example": 10
                    },
                    "done": {
                        "type": "integer",
                        "example": 3
                    }
                }
            },
            "Work": {
                "type": "object",
                "properties": {
                    "id": {
                        "type": "integer",
                        "example": 1
                    },
                    "title": {
                        "type": "string",
                        "example": "Fix login bug"
                    },
                    "description": {
                        "type": "string",
                        "example": "Fix the login redirect issue"
                    },
                    "type": {
                        "type": "string",
                        "example": "bug"
                    },
                    "status": {
                        "type": "string",
                        "example": "untouched"
                    },
                    "assignees": {
                        "type": "array",
                        "items": {
                            "type": "object",
                            "properties": {
                                "id": {
                                    "type": "integer",
                                    "example": 2
                                },
                                "name": {
                                    "type": "string",
                                    "example": "John Doe"
                                },
                                "email": {
                                    "type": "string",
                                    "example": "john@example.com"
                                }
                            }
                        }
                    },
                    "project": {
                        "type": "object",
                        "properties": {
                            "id": {
                                "type": "integer"
                            },
                            "title": {
                                "type": "string"
                            }
                        }
                    },
                    "createBy": {
                        "type": "object",
                        "properties": {
                            "id": {
                                "type": "integer"
                            },
                            "name": {
                                "type": "string"
                            }
                        }
                    }
                }
            },
            "CreateWorkRequest": {
                "type": "object",
                "properties": {
                    "title": {
                        "type": "string",
                        "example": "Fix login bug"
                    },
                    "description": {
                        "type": "string",
                        "example": "Fix the login redirect issue"
                    },
                    "type": {
                        "type": "string",
                        "example": "bug"
                    },
                    "assignee": {
                        "type": "array",
                        "items": {
                            "type": "object",
                            "properties": {
                                "id": {
                                    "type": "integer",
                                    "example": 2
                                }
                            }
                        }
                    }
                },
                "required": [
                    "title",
                    "description",
                    "type",
                    "assignee"
                ]
            }
        }
    },
    "paths": {
        "/auth/register": {
            "post": {
                "tags": ["Authentication"],
                "summary": "Register or login user via GitHub",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/RegisterRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "User registered or logged in",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/RegisterResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Missing code"
                    },
                    "500": {
                        "description": "Internal server error"
                    }
                }
            }
        },
        "/auth/profile": {
            "get": {
                "tags": ["Authentication"],
                "summary": "Get logged-in user's profile",
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "User profile retrieved successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "user": {
                                            "$ref": "#/components/schemas/User"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "404": {
                        "description": "User not found"
                    },
                    "500": {
                        "description": "Internal server error"
                    }
                }
            }
        },
        "/github/repo": {
            "get": {
                "tags": ["GitHub"],
                "summary": "Get all GitHub repositories for the logged-in user",
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of GitHub repositories",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "repositories": {
                                            "type": "array",
                                            "items": {
                                                "$ref": "#/components/schemas/GitHubRepo"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "GitHub not connected"
                    },
                    "500": {
                        "description": "Internal server error"
                    }
                }
            }
        },
        "/github/repo/{projectId}": {
            "post": {
                "tags": ["GitHub"],
                "summary": "Link a GitHub repository to a project and create a webhook",
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "parameters": [
                    {
                        "name": "projectId",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer",
                            "example": 1
                        },
                        "description": "ID of the project to link the repo"
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/GitHubRepoCreateRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "GitHub repo linked successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "GitHub repo linked successfully"
                                        },
                                        "repo": {
                                            "$ref": "#/components/schemas/GitHubRepo"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "GitHub not connected or invalid project"
                    },
                    "404": {
                        "description": "User not found"
                    },
                    "500": {
                        "description": "Internal server error"
                    }
                }
            }
        },
        "/github/webhook": {
            "post": {
                "tags": ["GitHub"],
                "summary": "Receive GitHub webhook events",
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Webhook processed",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "unmatched": {
                                            "type": "array",
                                            "items": {
                                                "type": "string"
                                            },
                                            "example": [
                                                "commit message that didn't match"
                                            ]
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Error processing webhook"
                    }
                }
            }
        },
        "/project/create-project": {
            "post": {
                "tags": ["Project"],
                "summary": "Create a new project",
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/ProjectCreateRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Project created successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Project"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Missing required fields"
                    },
                    "500": {
                        "description": "Internal server error"
                    }
                }
            }
        },
        "/project/active-projects": {
            "get": {
                "tags": ["Project"],
                "summary": "Get active projects for the logged-in user",
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "parameters": [
                    {
                        "name": "page",
                        "in": "query",
                        "schema": {
                            "type": "integer",
                            "example": 1
                        }
                    },
                    {
                        "name": "page_size",
                        "in": "query",
                        "schema": {
                            "type": "integer",
                            "example": 10
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Active projects retrieved successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal server error"
                    }
                }
            }
        },
        "/project/analytics/{projectId}": {
            "get": {
                "tags": ["Project"],
                "summary": "Get project analytics by projectId",
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "parameters": [
                    {
                        "name": "projectId",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer",
                            "example": 1
                        }
                    },
                    {
                        "name": "selectedUser",
                        "in": "query",
                        "required": false,
                        "schema": {
                            "type": "integer",
                            "example": 123
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Project analytics",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ProjectAnalytics"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Access denied"
                    },
                    "500": {
                        "description": "Internal server error"
                    }
                }
            }
        },
        "/project/project-progress": {
            "get": {
                "tags": ["Project"],
                "summary": "Get project progress for logged-in user",
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Project progress retrieved",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "No projects found"
                    },
                    "500": {
                        "description": "Internal server error"
                    }
                }
            }
        },
        "/project/project-deadline": {
            "get": {
                "tags": ["Project"],
                "summary": "Get projects near their deadline",
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Projects near deadline retrieved",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "No projects with deadlines found"
                    },
                    "500": {
                        "description": "Internal server error"
                    }
                }
            }
        },
        "/user/adduser": {
            "post": {
                "tags": ["User"],
                "summary": "Add a user to a project",
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/AddUserRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "User added successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/User"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "User does not exist. Invitation sent"
                    },
                    "500": {
                        "description": "Internal server error"
                    }
                }
            }
        },
        "/user/{projectId}": {
            "get": {
                "tags": ["User"],
                "summary": "Get all users for a specific project",
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "parameters": [
                    {
                        "name": "projectId",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer",
                            "example": 123
                        }
                    },
                    {
                        "name": "page",
                        "in": "query",
                        "required": false,
                        "schema": {
                            "type": "integer",
                            "example": 1
                        }
                    },
                    {
                        "name": "page_size",
                        "in": "query",
                        "required": false,
                        "schema": {
                            "type": "integer",
                            "example": 10
                        }
                    },
                    {
                        "name": "search",
                        "in": "query",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "example": "john"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Project users retrieved",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/UserListResponse"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal server error"
                    }
                }
            }
        },
        "/user/{projectId}/search": {
            "get": {
                "tags": ["User"],
                "summary": "Search project users by email",
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "parameters": [
                    {
                        "name": "projectId",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer",
                            "example": 123
                        }
                    },
                    {
                        "name": "email",
                        "in": "query",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "example": "john@example.com"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Search results",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean"
                                        },
                                        "count": {
                                            "type": "integer"
                                        },
                                        "data": {
                                            "type": "array",
                                            "items": {
                                                "$ref": "#/components/schemas/User"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Email query parameter missing"
                    },
                    "500": {
                        "description": "Internal server error"
                    }
                }
            }
        },
        "/work/{projectId}/create-work": {
            "post": {
                "tags": ["Work"],
                "summary": "Create a new work item in a project",
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "parameters": [
                    {
                        "name": "projectId",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer",
                            "example": 123
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/CreateWorkRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Work created successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Work"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Missing required fields"
                    },
                    "500": {
                        "description": "Internal server error"
                    }
                }
            }
        },
        "/work/{projectId}": {
            "get": {
                "tags": ["Work"],
                "summary": "Get all works in a project",
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "parameters": [
                    {
                        "name": "projectId",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    },
                    {
                        "name": "page",
                        "in": "query",
                        "required": false,
                        "schema": {
                            "type": "integer"
                        }
                    },
                    {
                        "name": "page_size",
                        "in": "query",
                        "required": false,
                        "schema": {
                            "type": "integer"
                        }
                    },
                    {
                        "name": "user",
                        "in": "query",
                        "required": false,
                        "schema": {
                            "type": "integer"
                        }
                    },
                    {
                        "name": "status",
                        "in": "query",
                        "required": false,
                        "schema": {
                            "type": "string"
                        }
                    },
                    {
                        "name": "type",
                        "in": "query",
                        "required": false,
                        "schema": {
                            "type": "string"
                        }
                    },
                    {
                        "name": "search",
                        "in": "query",
                        "required": false,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of works",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "total_count": {
                                            "type": "integer"
                                        },
                                        "page": {
                                            "type": "integer"
                                        },
                                        "page_size": {
                                            "type": "integer"
                                        },
                                        "link": {
                                            "type": "object"
                                        },
                                        "data": {
                                            "type": "array",
                                            "items": {
                                                "$ref": "#/components/schemas/Work"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal server error"
                    }
                }
            }
        },
        "/work/{projectId}/update-work/{workId}": {
            "patch": {
                "tags": ["Work"],
                "summary": "Update an existing work item",
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "parameters": [
                    {
                        "name": "projectId",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    },
                    {
                        "name": "workId",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/CreateWorkRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Work updated successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Work"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Missing required fields"
                    },
                    "500": {
                        "description": "Internal server error"
                    }
                }
            }
        },
        "/work/{workId}": {
            "delete": {
                "tags": ["Work"],
                "summary": "Delete a work item by ID",
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "parameters": [
                    {
                        "name": "workId",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Work deleted successfully"
                    },
                    "500": {
                        "description": "Internal server error"
                    }
                }
            }
        },
        "/work/{projectId}/stats-card": {
            "get": {
                "tags": ["Work"],
                "summary": "Get work stats for a project",
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "parameters": [
                    {
                        "name": "projectId",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Project stats retrieved successfully"
                    },
                    "404": {
                        "description": "Project not found"
                    },
                    "500": {
                        "description": "Internal server error"
                    }
                }
            }
        }
    }
}